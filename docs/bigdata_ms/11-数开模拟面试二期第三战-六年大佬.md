#11 - 数开模拟面试二期第三战-六年大佬#

> 提取时间：2025/11/09 12:47:34

你好你今你是今天的面试者对吧，学的有一些技术站，有这个java cola和DP，以及这个书商方面的，要不你先做一个简单自我介绍好吧，嗯好的，那是管我叫辉煌，然后毕业于广州大学2017届的，目前已经毕业6年，主要从事与数据仓库的开发，然后目前已经是在返航供应链，做一个从0-1的数据仓库搭建的过程，然后目前已经把离线全部开，开发的都已经开发完了，然后开始往DWD和DI，跟数据建模方向推进业务，然后再往上份额可能就是产区科技大厦，主要主要是给移动那边做业务，然后平时主要负责的业务主要是1439，油箱和短信总裁嗯，然后涉及的业务量大概就是月活六六千多万，月活1.8亿，数据大概在37左右吧，每天数据量不是邮箱业务是吗，是的，然后再往下就是那个做完新业做小信贷的工资，然后主要用的是spark什么in part in para to do，来做收藏，然后主要负责的是整个公司的bi加移速，加数仓建设，基本上都是什么，不要做，还配了OGG用户抽数那些东西，然后最开始是在广州立白做java qc那些操作，这是一个后端项目吗，是的，我刚毕业是在做后端，然后来深圳之后就转出仓了，嗯大概是初三，有工作几年了吗，这操作有6.8K，你这边这个年限是比较高的，我看到刚才你提到第一个项目里面，再做一个从0-1的一个受伤搭建对吧，对然后这个这个里面里面有团队，有几个人去做这个受伤的一个建设的啊，就我一个摸铁，那你大概就是平常工作的话，会接触到什么什么同事呢，就是他们的岗位是什么类型的，我目前只有一个什么都不懂的老板以及业务，后端吧，我们那个说是数据团队有三个人，其实主要目的都是我在做另外两个，还是在做后端，然后公司之前把另外两个做后，做后端的人转来做副仓，但是人家的业务又不可能停止开发，就是感觉为了哄哄而已，那这个意思就是说让后端并行，这个业务系统的开发与这个数仓的一个开发，对吧是的，然后就是想把你这个位置给切掉，是这样吗，切到不可能切吧，这能让我教他们，但这个后跟他们没有怨言吗，那多忙啊，这样有啊，是是是是啥背景，就是因为我我老大，因为这个项目做完之后，可能有有可能低跻身为副总裁能力啊，挤到短短进去，3月底，等你转正了吗，转正了嗯，我觉得可以先待着吧，然后咱看看起来不太靠谱的样子，就是不太靠谱啊，哎那你们除了这个项目没有别的项目了吗，就只能在这待着是吧，嗯其实还有啊，比如说我们是做供应链的吗，有很多OMSK那些物料RPSPIN系统，然后这个评论有一个说这是个假象，我是说是培训机构的，这个人我也不知道如何出此狂言呀，这是一个幼年的大佬啊，这是幼年的大佬，我是混子，不是混不混无所谓，但是有的东西是什么就是什么，对吧，挺不错的，但是我感觉你这个可能可能机遇不是很好，现在嗯看一下你这个6年到底是什么样的水平，可以吗，问问一些评论，好吧好，我们看一下，然后昨天又整理了十道题目，今天增加到大概36道，我们大概问个20分钟左右吧，或者十几分钟就是这样的好嗯，第一个看大佬，您如何评价这个好的这个维度建模呢，我觉得需要从3-4个方面来说吧，嗯嗯嗯第一个表保证就是质量，一个好的数据建模，但是他们他们首先保证他的数据一定是准确的，口径，一定是全公司唯一核对的就是唯一检验的标准，嗯然后其次是相信，如果在规定的时间内没有出准确的数据，那么也没有啥效果，没啥意义，然后第三是指它的存储空间，然后如果这张这张无偿的表，比如说它涉及到特别特别高，并没有对浪费子公司很多空间，在我看来也算是很好的，然后还有一个是取消是，还有一个是融资服务中心，就是这个数仓，这个这个这个层级，不是只能从这个字开开发用一次，那应该还需要兼顾到以后后续的业务，相当于为后续的开发做基础，就火光，后面的步骤讲的是一个扩展性对吧，哎我想就是我想就就我一个角度问一个问题啊，你比如说有一个业务，它涉及到呃会员用会员表，然后还有一个普通用户表，但是他们本质上都是用户嘛，只不过第二第一个他是一个会员用户，那这种，比如说以为我们围绕他们去出了一些画像标签，并且这些化学标签是差不多的，就是基本上字段数量是一样的，含义也一样，你觉得这个应该是加到一，就是放到一张表里面去，做一个顶层的一张表，还是说要拆开更好，如果是我的话，我会把它合在一起，其实这个有一个情况，就是说在后期就是分析角度的，这个后期，他分析师可能对于会员用户跟普通用户，分析的维度稍微有些不一样了，你比如他会分析会员，这个这一年的一个消费情况，分析普通用户近两年的一个消费情况，但是他们各部各不相关，你懂吗，然后呢在后期可能又加了另外一个用户，比如说是一个车牌用户，我举个例子啊，然后那这样的降一级去叠加的话，那你这张表就相当于自断会出现不不不如，不一样的情况，然后这个数据的类型也会一直在增加嘛，然后可能明天又增加一个什么停车用户啊，之类的，那像这种情况下，你觉得是一直累加，还是说根据业务再去调整，怎么如果这两张表没有任何管理关系的话，就肯定会拆开比较好，如果有关联关系的话，不冗余到一张表里面，然后尽可能的相当于做信息模型的时候，能减少交易操作，但是如果现在都没打业务观点，就是两个两个看听上去名字像不像，但实际上业务没有任何关联关系的话，我就可以按两个维度系并拆分开，嗯嗯嗯对，然后我说一下我的这个看法，就是为什么有这个场景，前期就是我们去把它应用起来，是因为那这业务稍微比较简单嘛，因为应用到一起也是做的做起来比较快，并且也符合业务，但是后期呢这个业务扩张以及这个分析角度，一直在增加嘛对吧，然后导致这个这个表使用起来不是那么灵活，只为了拆解这个表结构呢，然后增加这个灵活性对吧，后面然后把这个表给拆开，然后我们是有这样的一个场景哈，然后看下一道题吧，嗯这道题其实有一点坑的，你可以简单说一下你的理解，害我害我，在我看来好累，会更像一个分布式文件系统，就是有点跟HDSS有点类类似的东西，本质上就是根据hp s文件工业设一加载进去，然后跟数据仓库的区别就有一种包含关系，毕毕竟数藏又不单独指定，太可以用其他方式来做，比如说h base之类的嗯，嗯数据残破在我看来更像一种思想，一种一种理论，嗯跟实际用什么数据库，哪怕用传统传统数仓，也可以低于数据搭建数据仓库，只是技术站不太一样，而是嗯，那你觉得这个数据仓库它是为什么而服务的呢，我觉得应该是更像是用数据分析，就是偏数据分析那一块，因为因为最终和金都是为了做报表，嗯嗯那报表的意义就是为了给领导做决策，改变公司策略的，所以我的理解应该就是更偏向于，用，OK嗯哎你觉得就是我们开发的话，是从这个业务系统出发这个角度好，还是说从这个分析顶层的分析角度开始出发好，我比较偏向于从下到上台吧，就是用用那个需求需求来驱动业务哦，就字典向下对吧对OK那这个没问题啊，我们来看一下下一嗯数据测试的方法，就可能偏向于一些指标之类的，或者这个数据调调速方面的，你看一下有没有您的意思，就目前之前做过的增量采集的，自己做生产力会有一个全首日全量，然后拿去做数据量对比了哦，是偏这方面的嗯，测试就会有一些校验嘛对吧，校验的一些方法，嗯我之前是有做过那些指标对数的一些校验，嗯就比如说我们要139邮箱那个项目，因为是要有往下游传递接口文件，所以我们是有一个邮件对比脚本，然后把每天往下游传递的表，数据量跟接口文件数据量做对比，然后判断是不是数据不一致或哪边出问题了，然后做出邮件预警，包括一些重要的指标阈值啊，比如说今天的下发量跟昨天的下班少了，30%，然后有的会有那种预警预警提醒，然后就知道可能是比如丢住了，或者日日日志少了之类的，主要是弥补，OK但你会针对一些，比如说一些字段的异常值的一些测试嘛，比如说你刚才提到的就是有一些数据调色，以及它这个数据的完整性，你比方说他的有一个字段，它里面比方说都是应该这个值为十的，至少有30%，那这个我们比如说这个空置率，达到了90%，那像这样的情况下，我们有做一些校验吧，或者说有是忽略掉了，还是说有一些处理，这时如果达到9%，所以肯定应该会是的，毕竟我们也会DW就可能多提醒，就比如说你ODA和出来有100万数据到DWD，洗完之后，平常使用的你到包包表一一跑完，可能估计就有个56万56万的数据，那就会觉得很奇怪，就一般就是几个，当我第一次开发的时候，会去做一个校验吗，空值的话应该也会有，现在不是DS，但有很多空置的脚本就是这种设设置吗，它可以根据每个表的重要指标，字段落去配置对应的规则，那个小试点，OK那你们有没有这个，你了解数据膨胀这个名词吗，我提供数据发散对，也叫数据发散，就是你看我也有一个这样的场景，就是不知道上游是什么情况，但是他这个数据量呢从一个比如说是100条啊，他翻倍翻到了350，具体翻的是3.5倍，但是里面有一些条例，有的是翻倍，有的没有翻倍，那像这种情况，我们是会自动预警吗，有没有做一些处理的，还是说就是发现之后才会再做处理嗯，这种在上上证公司是有自动预警的，就是我们会设立一个合理的预警吧，就比如说拿1396加那个每天，每天要采集用户的行为，点击日志那些表，经常会出现卡不卡机啊，丢数那些，或者把数据机放机啊，第二天这时候我们一般会超过13%左右，就看你这个标准，然后默认就超过了，就开始去追追查上手卡夫卡的数据，是不是没有消费完，然后怎么补救，如果低于这个阈值，那里我们就不会管，除非等到页数的时候，然后再去判断了，OK那其实我这里想提到一个，就是属于质量方面的，你比方说配一个质量规则，就是说你T加一的这个日期的数据啊，比T加二的这个数据呃，比如说增长了200%，然后这个阈值呢，可以就是当为我们一个数据暴增的一个预警嘛，但是这个预警不一定就是说异常哈，这有可能就是说我们业务系统的一个，访问量暴增，业务暴增，但不排除第二种情况，就是上游出现了一些呃数据异常，任务的一些异常对吧，懂了理解吗可以，然后你刚才提到了一个卡夫卡嗯，那假如说呃我们不不管这个补数的情况下，就比如说有一条实时的链路，那我们有没有，你有没有做一个离线的校准之类的，实时我不要做的事，但是我知道基本上实时项目做完之后，每天晚上应该都会有一个，应该都会和离线的指标去做对数，要不然就以4-80是丢数了，可能都不没没太清楚嗯，因为我们知道那个离那时时，他其实丢树的这个可能性是很高的嘛，然后我是有一些应用场景的话，可能会有一些lambda架构，比方说我们有一个实时可以一个耗子表，然后我们是每天的实时的写入对吧，然后我们是T加一的，将这个离线数据根据写一样的这个脚本，就是可能代码不一样，一个是FLINK，一个是have spark这种，然后用同样的一个业务逻辑，去把它们处理成这个，那么A架构就是第二天会写到，把那个实时表里面那个T加一分区，给他重写一遍，相当于把离线，把那个实时数据给做了一个重复盖，能听懂吗，能你觉得这个方案怎么样，呵呵你这样不行吗，那如果他就是我们有个体验，就是离线和实时的数量对不上的时候，就就以离线数据量覆盖掉持续的对，如果对的上，就不需要覆盖呃，这个到对诶，你提到这个点我觉得很好啊，目前的话我们可能就是直接的离线校准，事实就是没有什么校验啊，就直接就是覆盖式的，因为那个实时系统其实没有那个离线，离线里面还带的字段比较全一点，你可能实时里面还有一些缺失字段，是这样的，然后所以我们就直接就是把那个数据全给他，封盖过来，他有一些手机号呀，QQ号呀对吧，都不太全，我们先用这种方那个给补做的补充，那我感觉也没必要说每天都覆盖掉了，就是对不上的话，我是觉得实时肯定是准于离不，离线是准于实时，那对不上的时候就以离这离线的数据为准，直接覆盖掉，对得上的话，那离线的数据可以直接拿去计算呀，是这样的，就是我们可能就是业务层再去分析的时候，他们他们不太适合去用两张表，然后我们相当于是把离线和实时做到了一起，是这样的，并且呢，比如比如说里面有一个这个有一个车牌字段哈，但是你的实时里面可能带过来，这个字段有时候是空的，因为他那个车牌校验它就是一个实时检测嘛，他有可能那个车牌没有检测出来，他就没有上传成功，但是我们离线数据里面，是可以根据它一些yd去做出来，他这个真正的车牌的，所以说离线里面的一些字段可能会更全，那对于我们这个数分去做这个业务分析的，那个数据也更加的真实，是这样子的，那你们这里其实是为了计算下，就是为了实时的触达他，那个比方说他是一个停车对吧，我们知道他停车之后可以给他发一个短信，然后进行给他出发出发发一个这个优惠券，然后去做一个门店的一个销售这个消费，那举个例子啊，这个可能时时不涉及到，可能对这部分业务可能不太适用，但是对其他业务挺满足的，所以就当时当时就考虑了下，其实嗯你这个实时的顶层主要是为了干什么，我还没上呢，我亲啊，上线公司没上过吗，我主要是做了一个很简单的卡夫卡拖拉机DMF，对后面的你有了解，他是想要干嘛吗，他们是想做一个，比如说拿离线的下发率，跟在知识的成功率做对比，然后它的回收率到了到了一个稳定值，然后运营那边就不需要做任何处理，如果不值率低于99%以下，然后运营那边需要加加大团运营复员投递，平台那边的邮件和短信的下发量，把率强大，相当于把数据刷数据，为了刷数据，把数据弄好看点，大概就这意思啊，OK全在再看两个视频，哎呀这个题好low啊，呵呵你简述一下吧，来吧哎呀这个最近搭搭的多了，感觉跟第一次月经一样又出现了啊，你最近在练习搭建吗，没有躲过大电，刚开始搭建这个没经济就打好了，我那时啥都不懂，领导让我到东改西改，我真的打了四遍嗯，哎你们你们是现限公司搭建的，是这个原生的哈德利的哦，这一套好刷，你们为什么没有了解这个开源的一些集成式的，一些生态组件呢，就是他都把这一套我也考虑过CPH啊，要考虑过云呢，应该说他考虑的选吗，嗯那所以说我们没有选择对吧，OK呵呵，对我给他出过技术变心的，因为我当时知道公司没有运维，我是巴不得剩余的，你可以简单讲述一下你搭建的哪有哪些组件吗，就是说一下有哪些组件就可以呃，主要他了哈，杜甫去DFS一样，再看看多人能不能弄，For manager，Faa manager，Spark have on start，然后配套差DB z e zone from卡多卡，然后ADOLAS点关系，HBASE多了，大概就这些，然后后面你应该考虑到格林豪斯的那个弗雷德，还没，目前还没有业务，没有合适的场景，让我去让我去练手，OK那你刚才说到一个是有一个oz，是你们是用到oz吗，没有我刚才听没有一个听错了，他说没听清，说了吧，solar哦，是那个搜索引擎吗，对哦不是，还是跟那个艾特一起的那个维度，建模的过程的一个顺序，还有你再简单举个例子呗，纬度变化啊，其实是首先基本上都经常最烦人的数据调研嗯，然后判断表来自于哪个业务，有什么有什么字段，然后把这些表注释类型都都不清楚之后，然后根据他的，业务情况还能增量还是存量抽取到ob s，然后同时根据数据了解了就了解了列表啊，做更多建一个业务矩阵，看看哪个数据，这个这个表示这个需求是来自于哪个数据的，然后根据他构建的话，他那个业务取证，然后就把DM跟第一层，直接可以根据他名字表拖拖出来，能能简单举一个业务场景吗，就描述一下大概是什么业务，就比如说我们做一个合同，这个要不第一层是知识表，我们要统计七天和他的手书这种治疗，然后我们刚刚出去，等下去找这个表是来自于哪个业务，哪个业务业务业务系统的，然后比如说这个用户这个合同他是来自合成玉，合成玉下面有具体的用户，好像试试过过程，有具体的用户，然后下单，然后还有出口出关，出口进口之类的操作，然后它对应的市值是这些，然后对应的维度需要擦出来，简单来说就是进口停靠感，进口进口出口国，然后区域受组织的id，然后以及涉及到哪些商务人员，业务人员这些违规动，然后就开始找他们的猪，就因为现在这已经达到了500的，就是到40表已经确定了，然后就找它对应的主维度表，然后把他的数据必定进行进行信息量拆分出来，好那我感觉今天问的差不多了，要不你看有什么想问的吗，我们可以探讨一些书开方面的，有没有啥FLINK的项目可以让我跟看一下，因为去年学的FLINK自己做完之后，今年前几天写项目，写写写简历的时候，我就看了一眼，感觉就跟看天书一样的快，嗯你指的看天书一样，是指的技术还是什么技术吧，技术嗯，我觉得你可以先把菲和那个，你可以看一下基础教程嘛，看一下三维谷啊，或者其他机构的一些基础教程对吧，这是第一个，然后你可能搭配SCALA或者java，去做一个这个开FLINK的开发，那可以搭配一个这个比较新的那个在线教育，还有那个电商和那个医疗的一个项目，他们是应该是7月初刚出的，一个上微博的那个实时项目，然后我们已经有同学在看那个在线教育的，是是这样的，你可以跟他们群里探讨一下，就是那个上美股的一个在线教育，是有人在看的这样的，然后还有个问题想问的，就是您觉得克里斯跟QRS那个嗯，嗯那个可能这有什么好处，因为我现在对OIP这一块好像都没怎么有，实际上业务接触过，然后我先首先说一下，就是这两个组件呢我我前面用的比较多，就是可以和用的稍微多一点，然后我在我的认知里面，就是我们会使用horse，作为一个a abs层的一个数据建设，比方说我们DWS和这个CDM，就是CBM这一层吧，我们把这个业务所需要的所有业务对吧，我们抽离出来各种优化项，然后把这个用户发现我们去做一个拆分，比如说我们刚才说那个用户和这个会员，然后他们作为一个不同的一个表，然后各自具备一些业务需要的一些指标字段，然后他们就可以对这个格雷兹进行一个，单表的一个及时查询，然后这个特点的话，你比方说我们可以做一个one i d，然后使用clean cost里面那个beat map，去做一个这个字典表字典表，然后这个beat map的这个这个含义是什么，你比方说我们有十个用户，我们把十个用户这个进行beat map编码，那他这个十个用户，我们在使用BGM去查询这十个用户的时候，这个速查询的速度就会提升很多倍，然后这是便于我们业务去做一个OP的一个，典型的一个分析，然后假如我们输入量有10亿用户哈，那这10亿用户我们要去选里面，销售额近一年在这个2万以上，并且它这个性别是什么，然后他这个活跃度是什么样子，那这个这个点点击查询呢，对boss来说就是一个非常典型的例子，就是他那个优点所在，就是处理这个像那种有有一些组件的一些表啊，然后他们去做一个大数据量的吞吐，然后就是给业务快速的展示出这个数据和结果，但DOS的话他也是一个OLAP的一个引擎嘛，对吧，一个数据库，那他这个东西说实话他那个分析分析的函数哈，比这个close要稍微维度要多一些嗯，像它有一些聚合函数，它有一些很多五花八门的一些聚合，聚合的那些函数，然后说说实话，克雷诺斯跟德瑞斯，他这个两个SQL已经稍微有点偏离准circle了，因为它有一些函数跟这个普通的mysql vehicle have，对吧，跟他们一个语法是有一点差异的，而且基本上每个函数都有差异，基本上，我觉得你可以了解一下dis，然后如果你对DORIS有一个简单的认识的话，我们可以再再聊一下，就是我可能对多比较薄弱，是这个意思，OK好嗯，嗯我还想问一下业务，您业务的问题，就是您这边用户画像，是根据公司自己内部定义的行为，然后来打标签吗，嗯这个的话，首先就是比方说我们从0-1加大电哈，那肯定有一个数据调研和就业务调研的一，个情况对吧，那在这个前期可能会搭建一个这个，纸面画像的一个出版，那个出版里面，我们会对我们现有的业务做一个整理，然后做一些分析指标的一些划分，然后再去看这每一个指标去对应的什么表，然后他们我们再去根据这个指标呢，去做一个主主题域，然后我们在自顶向下的开发的时候，把这些业务线去理清之后，再划分一下他们的数据，在这个里面就是涉及到B，我们跟BA分析师一个合作，他们主要就是对业务一个分析，然后我跟我们一起去做这个指标，体系的一个完善，但是这个主要的一个牵头人的话，可能在分析师那边，就他们会出一些就是适合业务去做使用的，一些指标，比方说他们会设计一些用户的一些流失，流失归因啊对吧，有一些活跃的一些归因啊，然后但是这个东西可能不是数仓的一个特点，它不是受伤，就是不是我们树开树开的一个专业技能，主要是两双方去配合做这个东西的，好，啊你我这边已经没有什么问题，您这边还有什么想问的，没啥想问的，有空的话，我们就群里聊就好了，呵呵好好，那就这样，拜拜好辛苦了，拜拜拜拜

