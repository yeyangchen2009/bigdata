#20 - 程序员数仓面试偷偷录制 可能会删 数据仓库大数据数据开发校招秋招春招-第三期#

> 提取时间：2025/11/09 12:47:34

hello你好，然后我们今天来对你进行一个面试啊，就是来做个简单的自我介绍吧，控制在30秒左右好吧，声音大一点嗯，呃面试官您好，我叫花花，来自呃桂林理工大学，现在嗯在校，现在是本科大三，在校的专业是计算机科学与技术，在校期间我参加过多次社团，在大一的时候参加过呃，一个个硬硬件儿类的社团，然后大二通过考核进入了一家呃，就是有关大数据的一个科技社团，然后在社团中我学习了一个，学习了相关的组件及大数据的架构，还有副仓的建模方法，里边嗯也完成过两项目，一个是一次远，一个是和一个广告收仓的项目，嗯嗯你现在是大三呃，你进入了一个社团，然后开展了大数据方面的学习是吗，对的我想问一下，我想问一下，就是你主要呃学习的这个，比如说路线以及具体的内容啊，这块东西是是怎么具体去学的，路线肯定是额在网上先查一下资料，就是按顺序去写，之后呢，学的过程中，如果嗯就是就我先是快速过一遍，然后不懂的之后我是不死磕，这种不懂的我会回来就是重复看之后，我会继续推动网下进一步学，你是通过什么渠道学习的呢，嗯可以通过社团社团一些和学长学姐的经验，或者是在呃文档社区有一些学习资料，还有呃网上也有些课程啊，那你你在学习网上这些东西的时候，有没有什么痛点，对于你个人来讲，或者说你觉得学的怎么样，你觉得有没有什么痛点，痛点的话，我觉得在项目中有一些痛点，就是我可能会一些遇到一些就很多的报错，都需要自己去试，自己去本科就是去解决，可能就是跟网上那些不同，然后学习的话嗯，学习就是有不懂的地方，但是后来就是重复的看，重复的看也可以，过去也容易遗忘，但是也需要重复的，就是去看，你能举一个报错的例子吗，我听到刚才听到你说经常报错对吧，你能举一个例子吗，举个例子的话，SCP代码去读写HDFS会报错，你没有这个权限，啊啊啊，然后呢怎么解决呢，你解你解决的整个链路是什么样的，没解决没解决哦，OK这个问题你都你看啊，你都用中文向我表述清楚了，应该很好解决的，额没记错的话，他应该是在用java对吧，喂斯嘎嘎写死嘎查线也一样，它里面应该是有一个这个系统的系统的名字，系统用户名，它设置那个你对应的哈哈，do本里上面的那个用户其实就可以，或者说你如果是公司的集群的话，你可以配置对应的一个呃账号的一些这个信息，你自己集群的话，其实用一个那个哈，都不上集群的一个AHCFS的用户就可以了，这东西应该GBT1行代码就可以出来了，了解OK我看一下你的简历哈，嗯你语言这块java scala，Python哪一个比较熟悉啊，java比较服务器，scar l是可以开发一些rd d算子的spark代码，然后Python只是了解一些语法，考java比较熟悉嗯，你写过这个java什么的，什么程序啊，java结合大数据来说，就是那些niper reducer这些迈克嗯，SSPARK之后就用scar，你看啊像在大数据场景的话，比如说我们在工作场景里面会有一些加解密啊，或者说有一些这个数据的一些算法啊，数据的一些数学计算对吧，那用java去实现一个，比如说DORIS的UDF或者HUDF，你你这个能实现吗，UDF的话就是继承了一个呃干预和UDF，然后去重写它的比ITIALIZE初始化方法，然后你来另外的计算逻辑，然后嗯get display string，这个呃演示了没啥用的，这个嗯嗯这个方法，然后如果是uni t f，uni uni t u d t f的话，就是继承那个JERRY和UDTTF，然后重写分解三个方法，然后一个是第一个是initialize，第二个嗯PROFECT，第三个close，那如果是UDAF的话，呃就实现那个abstract，呃我再问一个稍微深一点的问题啊，你用过这个嗯，就是日日的日日的一个一个价包吗，就是日志的logo吧，lol pro jj是吧，对对对对对，用过吗，嗯嗯用过这个spark程序跑，每次跑s spark代码的时候，他都会呃报一大串那个报一大串，那个是就是红色的那种，如果他那个如果说我们开发UDF的时候，其实啊UDF就是一个盲盒，就是我们打包之后呢，在生产上去跑的话，它其实就是一个盲盒，我们UDF发生问题之后，怎么去排查这个盲盒呢，去发现了问题，比如他报错了，他报了一堆这个报错，然后看过什么，看过什么阿帕奇什么东西对吧，就是你会用什么思路去拍他，比如说现在你就有个报错，就是你你脑子里面会想啥，先看看那个报错什么意思思，然后呢是不是什么空空指针异常了，还是越界了，这种这种的话就好排场，就看一下这个速度，香料之类的那种那种东西，然后如果是别的的话，那就看一下计算逻辑有没有问题，呃其实我们排查盲盒的话，嗯第一点啊，我们可能要对报错里面，就是去看他的报错的位置对吧，如果说是我们的业务代码，就是比如说我们自己定义的那个报名，出现错误了，它会有具体的行数，我们可以进行定位定位，如果说他没有这个看，看不懂这个业务类的代码，我们可以在这个UDF里面，用我们刚才说的logo for j啊，去给他做一个日志的一个打印，然后我们可以设置日志的一个等级啊，比如说我们想想看那个日志的时候，去传传达这个java里面配置，那开启，比如说info级别的一个日志嗯，这样的话我们去排查，不管你是UDF的生产还是测试，这样的话对于你排查这个UDF的一个，过程和错误都是非常有帮助的，要了解，你说一下说一下数仓数据仓库分层理论吧，你是怎么理解的，不是给你一个新的收仓，你会去怎么分层，首先是根据我那个额业务过程，先去做业务调研嗯，有数据调研，有嗯看验业务调研那种，点击某张表，看看它会对哪张表产生额影响，是新增一条还是额减一减，减少一条，或者是变变更了哪些指标，然后数数据懂我的问题，我说的是给你一个新的数仓，你会怎么去分层，分层的话对ODS层是ODS层的DSDWD，如果需要的指标比较少的话，就是随习大莱斯，直接就ADS，如果指标多，然后复用性比较高的话，就加一个BWS场，你能说一下你的DFD具体是呃，放哪些数据逻辑是什么吗，EWD是要放一些呃设施表嗯，主要是根据我的每一个业务过程决定的，有额选择业务过程统计力度，然后确定纬度，确定度量值，然后纬度不退货，就这几方面，它是通过额业务课，它是通过构建业务总线结算，然后得出来，也就是说你你们你这个思路里面，就是ODS是直接到DWD，并且DWD是一张宽表，对吧，嗯还要进行加工吧，进就是有的字段，有的字段是空的，就是需要额经济转化处理，就比如呃我的一些枚举值，我要把它翻译成那个字符串，比如零代表啥，零代表阳红肉质，然后一代表额离职，然后厂家婚嫁零代表呃，这些枚举值都转转译，然后比如我字段空的嗯，比如我出员工的出生日期是空的，或者是呃我的性别是空的，我可以用我的身份证号，然后去做一个填补，然后有的填补的没补充，补充不了的话，就没办法哎，我有一个比较深一点的问题啊，就是假如说你现在有ODS，有DDBDMD是这个宽表啊，你也做了一些这个分析转换，那比如说你做了一张宽表，是关于订单的，你这个表里面有订单，子订单，有商品也有物流，也有地址嗯，反正就是大部分信息都有了好吧，那现在如果说我我只针对子订单，要去扩展一些这个信息，就是我不要你其他的表，我只要子订单的一些扩展信息，并且它里面的加工逻辑跟你之前的DWG里面，加工逻辑是一样的，就是你你你有什么枚举转换，我也是这样转的，你觉得这张表应该放哪，做一些扩展是吧，我刚才说了，就是你首先有一张订单，子订单，商品物流地址，这张很宽的表，比如200个字段好吧，然后我另外还需要一只需要子订单，我需要拿着这张子订单去跟另外的表去做宽表，就他应该放在放在哪，这问题你听懂了，放在DEDDWDM什么层，EMEM为什么是DM，我没有说他是维度啊，那我不清楚啊，呃举个例子，比如说刚才站的角度，订单角度的话是用户的角度对吧，那我们如果想拿子订单去跟这个商家商家，他去商家其实有一个订单页面的，他有他自己的订单，他指定单里面可能有一些，比如说原价，或者说他曾经的历史记录版本啊，包括他这个照片，图片的个数，包括库存，那其实这个信息在用户那块是不需要展示的，那我那我商家这块也需要这样的一张表，就商家力度一个一系列分析，那这样的话我们相当于自子订单发生了复用，对不对，我们其实可以把子订单抽出来的，Four of nine knowledge，就我的建议啊，就是在这种有有真正的复用的场景的话，可以在DWD层做一张这样的一个，比如说只是此订单的一张表，然后你做好这些扩展之后，做好清洗一系列的清洗扩展嗯，之后去分别的被商家和这个订单的表引用，那么我们这个宽表，相当于就是我把你宽表的位置换了，我换到DWM侧，喂能听到吗，嗯可以可以吧，粉丝们这个这个分身人不行吗，行的打个一不行的，打个二啊，应该可以吧，就是说我我说的那个DWM，是你这些里面没有体现的，但是它其实跟你的dd是一个意思，然后他多了一个DWD，就是用来做单式式表的，此订单相当于单事实吗，那它就叫DWM层，但事实是DWD，然后你你之前的宽表就变成了DWM明细，中间层了解嗯，当然这个适不适合你们去用，这个要具体看场景，当然你也可以把指定的那套代码去复制过来，在我商家这个代码里面用对吧，也可以，其实现在很多公司这个设计，它其实都是有很多种的，就是他们是不统一的，主要是看你们公司的负责人，或者说你自己是怎么想的，如果说你有一定定地位，有一定的话语权，那其实这个东西你就可以去掌握全场，所以你说什么大家都跟着你做，我刚才只是给你提了一个问题，就是说当宽表它里面有一部分是复用的，并且有一些有一定的加工逻辑，对不对，我只是提了一个场景嘛，我看你是怎么设计，像这种的话，我的建议是，比如说在保留原有结构，原有分层，这个结构不变的情况下，可以去适当的在这种特殊特殊的表里面，比如DWD你可以做两做两做两个表，一个是子订单，一张单试纸，再去做DWD的宽表，也可以，只是命名上可能有一些冲突，这个跟你刚才说的那个从从那个DWD，直接到a abs，你不是说没有复用的逻辑，直接到ADS是说这句话了对吧，那其实跟这个是一样的，就是当你发现ADS它有复用逻辑，你才放到DWS，对不对，相当于你在中间加了一层嘛，加了个DWS嘛，是你强硬加的嘛，对不对对，那相当于我这句话就是强行加了个DWDWM，然后把你原先的宽表放放到DWM，然后中间再来个DWD是这个意思，其实其实数三分层，我今天讲的可能跟其他的视频不太一样啊，也不是不太一样，就是讲的稍微扩展多了一点，其实数仓分层它跟写程序是一样的，不管你写的是mapper还是re reducer，还是写的这个driver，它里面有抽象逻辑，他就可以去进行一个拆解，就是说书上分层它没有固定的，它是根据场景来的，一定是根据场景的场景，有可能就是比如说我是老板诶，按照我这就是场景诶，那我们我这个，我我感觉我们这个场景里面有一些比较复杂的，公用逻辑对吧，而且我们集团里面这个项目也比较多，然后并且这个表示核心表，可能很多系统都会去复用，那今天有个同学在提问，那个烟土模型对吧，烟囱模型指的就是说你单表，不是单单个这个主题域，就是自己玩自己的，比如说你用户的订单啊，你一直堆一直堆堆了一大堆，跟别的商家啥的，可能没有没有挂起来，那就烟囱模型嘛，对不对，那么这样的情况下，你是不是就没有把你核心的部分呃，做成做新核心表，做成一个公共的表去给大家给给大家抽离出来，让商家表去用，没有吧没有，那其实这个就是烟头模型，就是你为了某个需求做的宽表，做的ADS做的DWS，当我们去纵观全局，去看这些数据需求，看我们的数据表的时候，那其实分层就要动一动了，也不一定动分层，你单纯动表明也可以，就是我单纯的在这个DWD里面加了好几层，就是这个DWG是这个含义，这个DWE是这个含义，它们含义不一样，你可以这样干，就是很很恶心，当然我们分层一直改这个规范也很恶心，这个就需要这个有一有一个人去，在前期能够发现这些问题，并购并提前去设定好这些规则，因为可能数仓开发至少有两名一名的，那就不用不用规范了，对不对，一名就不用规范了，两名以上你都需要去规范去约约束他们的，你可能还会离职啊，离职的话，下一个人来了怎么干，对不对，他需要有规范去约束，所以说这个受伤的一个负责人很重要，具体后面新入新入住的同学，他干的爽不爽，进了公司之后，他是笑脸还是还是愁愁眉苦脸，就看这个了，因为我我们就是做数仓的，你这个数仓你的基础价值，你设定的规范这么恶心，然后包括之前的逻辑写的那么那么差，那肯定有问题的，所以说我希望你就是遇见这类问题的时候，可以根据场景去大胆的说就行了，我说了，它就是跟跟应用程序去面向对象开发是一样的，了解这个弹幕里面有同学分不清这些层的啊，后面可以看一下我的那个数仓分层理论，好吧，嗯你可以微信私聊我，我给你发链接，OK然后我再问你一个circle方面的问题吧，嗯你用过用过那个炸裂吗，哦我用过额，他这个炸裂，就是他不是需要那个letter view去做一个，在where下面写一个这样的方函数，data那它这个函数加outer和不加outer有什么区别，alter就OUTER啊，加这个和不加这个不区OUT呀啊对，没听懂是吗，我没加过奥特，没讲过，这你要谁讲，辉哥，辉哥给你讲，我不是我，我好像没加过这个，我都是letter v，好我看看能不能写笔，我是编辑，谁能编辑啊，就是比如说，然后OUTER，哎你看不到我屏幕是吧，我看不到，OK那那就是刚才那个问题，你应该分不清楚，他其实就是当你数组里面为空和不为空的情况，如果为空的话，它数据不加alter出不来，加alter的话才会出来，哎我说的对不对，有没说反啊，应该没说反吧，数组为空是出不来，我们ud tap里面不是放个数组吗，OK我们看一下你这个看一下你的这个简历吧，好吧，你简历里面写了一个自定义解析UDF函数，基于磁盘的IP解析了这个request url的地理位置，你是怎么根据IP去解析地理位置的，嗯就是嗯把把我把我这个离线的那个IP数据库，我发网到PFS路径上之后，重写那个UDF函数就用了一些嗯，用用了一些函数就就能解析出来，数据库是什么形式，MYSQL比如说RDBS点点点DBX，不是你刚才说有一个那个IP的地地址库是吧，这个库是存在哪，我把它放到HDFS上，那你的UDF是怎么跟他交互的，就我优点说有两个参数吧，第一个是传它的路径啊，传染一点白字路径，那我有个问题啊，那相当于就是你每次执行UDI，比如说UDF它执行的时长数据，那他就会有十次的调用，UDF里调用HDFS里面的那个地址库是吧，就，是吗，先调用一次之后之后不用掉，为什么不用掉，你每次执行他那个UDF都是都没了呀，你会做什么东西吗，会有什么优化吗，没有这块有没有去缓存，缓存一下他地址库那个地址库吗，啊没有啊，这块一定是可以去优化的，懂吗，一定是可以优化的，呃我记得你刚开始不是提说了，就是今天是4UDF里面，它不是有一个初始化的一个函数吗，对那块你放一个，你放一个map不可以吗，就是把我这个数据库给我加载到了，嗯对啊，而且而且这个ADS路径也不需要传进去吧，他应该固定的吧，对吧对呃，我觉得还是固定的啊，嗯再有就是你可以通过那个初始化的那个函数，去把它map给它塞进去，然后达到一个缓存的效果啊，具体再优化的话就优化那个map了，其实这个是很重要的啊，这个在工作里面就数仓里面，像你做这一类就是大量的检文本检索的时候，比如说这个你去AHTPSS拿一堆数据，再去判断它的一个地理，那这样的情况你一定是可以优化的，要不然会有很大的限制问题，比如说本来你可能5分钟跑一个任务，你加上这UDF可能要15分钟10分钟，并且对这个HT fs有大量的读写，我说没问题吧，没有好好嗯，再问你一个问题啊，circle方面的，在这个have里面，它有这个有rank，还有dance rank，这两个有什么区别，嗯rank的话就是我遇到名次，遇到名次相同的数据是保持不变，当嗯在紧接着之后是发生跳变，然后diss rap是名次相同的数据也是保持不变，但是紧接着上次的话是连续的，就就比如呃rank的话，就是1222，我听懂了，但是可能表达上还有一些欠缺啊，毕竟我们现在直播间呃至少有十名同学吧，感觉20位了，15位他的我觉得50%的人听不懂，我来表示3号，这个刚才我们这个同学的意思是说，rank他如果说有重复的排名，他排名是一样的，但是他的名字会断会有会有断层，名次会有断层，然后DRK的话它名次也会有一样的，会有同名，但是呢他的名次不会断，不会有断层，好蛋蛋白拆台，OK下次面蛋白OK，OK你这样吧，呃建议你去实习啊，我们就问这么多好吧，然后你看有没有什么问题，想想想一起聊一下的好，就刚刚呃，刚刚那个回头说那个就是把把数据库加载到，那你那时代的那个方法里，你知道，他那个计算逻辑不是是，不断的要调用，你是卡了吗，喂喂，好可以听见，可以听见呀，哦我就我就说那个嗯，数据库要在那个INFLAZE里加载一次的话，它计算计算方法不是也要重复调用，对他会重复调用，但是它减少了集群的IO呀，不是吗，第一点减少了集群IO，第二点减少了java程序的这个加载，数据加载喂能听到吗，嗯了解就你当当你去读像这个AHSS读数据，咱就说少一点，他十兆，那你比如说你有1000万行数据，那你每次都是都十兆，那是不是大了，Building action，猜万个，然后你java程序还要不断的加载，你要你还要新创建一个map对象，再销毁一个map对象，你频繁销毁了多少对象，对不对，好像不会自动销毁吧，它JC自动对吧，但是你需要你需要创建多少次呢，Map，而且你这个ACFS的链接也创建了N次，还进行IO，那第二天运维就会就会问你，为什么最近磁盘的读写这么高啊，比之前读高了20%到30，最后发现你你这可以优化，本身本身我们可能是跑在内存上的，现在被你玩的磁盘也要飞起来是吧，其实磁盘对于整个集群性能是很重要的，像一些程序它是需要写日志，读日志呃，需要去读MYSQL这种，如果说你磁盘IO达到一个极限之后，他对于整个集群上面的所有组件都会有影响，包括LINUX自自己，有啊还有啥问题吗，我没啥问题了，OK那我们今天面试就先到这里，其实我感觉你作为作为实际角度的话，掌握的还可以，但是站在数仓的角度的话，还是有一些地方可能是没有实际的经验吧，还是需要去补足一下书仓啊，包括一些java的基础啊，包括这个想分析说问问题的一些思路上，都还要加强一下嗯，OK那我们今天面试就就到这里，好感谢啊，嗯感谢您的励志，好嘞好嘞拜拜

